{% extends 'base.html.twig' %}

{% block title %}Trial Results - S4A Experiment{% endblock %}

{% block body %}
<div class="container" data-controller="confetti">
    <div class="app-header">
        {% if success %}
            <div class="alert alert-success mt-3">
                <i class="fas fa-check-circle"></i> Great choice! Your selection matches the theoretical association.
            </div>
        {% else %}
            <div class="alert alert-info mt-3">
                <i class="fas fa-info-circle"></i> Your choice helps us understand how people associate music and scents.
            </div>
        {% endif %}
    </div>

    {% if barChart %}
        <div class="chart-container mt-4">
            <h3>How other participants responded:</h3>
            <p class="text-muted">
                {% if task == constant('App\\Entity\\Trial\\Trial::MUSICS2SMELL') %}
                    This chart shows which tracks other participants chose for the same perfume.
                    The red bar (if present) represents the theoretically expected track.
                {% else %}
                    This chart shows which perfumes other participants chose for the same track.
                    The red bar (if present) represents the theoretically expected perfume.
                {% endif %}
            </p>
            {{ render_chart(barChart) }}
        </div>
    {% else %}
        <div class="alert alert-warning mt-4">
            <i class="fas fa-exclamation-triangle"></i>
            Not enough data yet to show statistics. Your response has been recorded!
        </div>
    {% endif %}

    <div class="row mt-4">
        <div class="col-md-12 text-center">
            {% if is_granted('ROLE_ADMIN') %}
                <a class="btn btn-secondary me-3" href="{{ path('app_home') }}">
                    ‚Üê {{ 'task.back'|trans }}
                </a>
            {% endif %}
            <a href="{{ path('app_task', {'type': task == constant('App\\Entity\\Trial\\Trial::MUSICS2SMELL') ? 1 : 2}) }}" class="btn btn-primary">
                Do another trial
                <twig:ux:icon name="bi:arrow-repeat" height="1rem" />
            </a>
        </div>
    </div>
</div>
{% endblock %}
